# 高斯消去法 (Gaussian Elimination)

> 解線性方程組最基本、最重要的演算法

## 1. 核心思想

### 目標

將線性方程組 Ax = b 轉換成**上三角系統** Ux = c，然後用**回代**求解。

```
原始系統：              上三角系統：
a₁₁x + a₁₂y + a₁₃z = b₁    u₁₁x + u₁₂y + u₁₃z = c₁
a₂₁x + a₂₂y + a₂₃z = b₂  →      u₂₂y + u₂₃z = c₂
a₃₁x + a₃₂y + a₃₃z = b₃              u₃₃z = c₃
```

上三角系統可以從最後一個方程開始，逐步回代求解。

---

## 2. 消去步驟 (Elimination Steps)

### 基本操作

1. **列交換** (Row exchange)：交換兩列
2. **列縮放** (Row scaling)：某列乘以非零常數
3. **列加減** (Row addition)：某列加上另一列的倍數

### 消去過程範例

```
步驟 0：原始矩陣
[2   1   1 | 5]
[4  -6   0 |-2]
[-2  7   2 | 9]

步驟 1：消去第一行（使 a₂₁ = 0, a₃₁ = 0）
R₂ ← R₂ - 2R₁
R₃ ← R₃ + R₁

[2   1   1 | 5]
[0  -8  -2 |-12]
[0   8   3 | 14]

步驟 2：消去第二行（使 a₃₂ = 0）
R₃ ← R₃ + R₂

[2   1   1 | 5]
[0  -8  -2 |-12]
[0   0   1 | 2]
```

現在是上三角形式，可以回代求解。

---

## 3. 回代 (Back Substitution)

### 從下往上求解

```
上三角系統：
2x +  y + z = 5
    -8y - 2z = -12
          z = 2

步驟 1：z = 2

步驟 2：-8y - 2(2) = -12
       -8y = -8
        y = 1

步驟 3：2x + 1 + 2 = 5
       2x = 2
        x = 1

解：x = 1, y = 1, z = 2
```

### 回代公式

```
xₙ = cₙ / uₙₙ

xᵢ = (cᵢ - Σⱼ₌ᵢ₊₁ⁿ uᵢⱼ·xⱼ) / uᵢᵢ
```

---

## 4. 主元與換列 (Pivot and Row Exchange)

### 主元 (Pivot)

每次消去時，用來消去其他元素的對角線元素稱為**主元**。

```
[2   1   1]     ← 第一個主元是 2
[0  -8  -2]     ← 第二個主元是 -8
[0   0   1]     ← 第三個主元是 1
```

### 主元為零的問題

如果主元為零，必須**換列**：

```
[0   1   2 | 3]    換列    [1   2   1 | 4]
[1   2   1 | 4]    ───→    [0   1   2 | 3]
[2   3   1 | 5]            [2   3   1 | 5]
```

### 部分選主元 (Partial Pivoting)

為了數值穩定性，選擇該行以下**絕對值最大**的元素作為主元：

```
[1   2   3]      不換列時主元是 1
[4   5   6]   →  但 |4| > |1|，所以交換 R₁ 和 R₂
[2   1   7]      選擇 4 作為主元更穩定
```

---

## 5. 消去矩陣 (Elimination Matrix)

### 消去操作可以用矩陣表示

「R₂ ← R₂ - 2R₁」等價於左乘消去矩陣 E₂₁：

```
       [1   0  0]
E₂₁ =  [-2  1  0]
       [0   0  1]

E₂₁ · A = 消去後的矩陣
```

### 整個消去過程

```
E₃₂ · E₃₁ · E₂₁ · A = U

或寫成：
A = E₂₁⁻¹ · E₃₁⁻¹ · E₃₂⁻¹ · U = L · U
```

這就是 **LU 分解** 的由來！

---

## 6. 奇異情況 (Singular Cases)

### 情況一：無法找到非零主元

```
[1   2   3]         [1  2  3]
[2   4   6]   →     [0  0  0]   ← 整列為零！
[1   3   4]         [0  1  1]
```

這表示矩陣**不滿秩**（singular），可能無解或無限多解。

### 情況二：增廣矩陣出現矛盾

```
[1   2 | 3]         [1  2 | 3]
[2   4 | 7]   →     [0  0 | 1]   ← 0 = 1 矛盾！
```

方程組**無解**。

### 情況三：自由變數

```
[1   2   1 | 4]         [1  2  1 | 4]
[2   4   3 | 9]   →     [0  0  1 | 1]
```

只有兩個主元，y 是**自由變數**（free variable），有**無限多解**。

---

## 7. 演算法虛擬碼

```
GAUSSIAN_ELIMINATION(A, b):
    n = A 的大小
    建立增廣矩陣 [A | b]

    for k = 1 to n-1:                    # 對每一行
        # 部分選主元
        找出第 k 行以下絕對值最大的元素所在列 p
        if A[p][k] == 0:
            return "矩陣奇異"
        交換第 k 列和第 p 列

        # 消去
        for i = k+1 to n:                # 對第 k 行以下的每一列
            multiplier = A[i][k] / A[k][k]
            for j = k to n+1:            # 包含增廣的 b
                A[i][j] = A[i][j] - multiplier * A[k][j]

    return 上三角矩陣

BACK_SUBSTITUTION(U, c):
    n = U 的大小
    x = 零向量

    for i = n downto 1:
        sum = 0
        for j = i+1 to n:
            sum = sum + U[i][j] * x[j]
        x[i] = (c[i] - sum) / U[i][i]

    return x
```

---

## 8. 程式實作重點

### 本單元程式示範

| 檔案 | 內容 |
|------|------|
| `gaussian_elimination_manual.py` | 手刻高斯消去法 + 回代 |
| `gaussian_elimination_numpy.py` | NumPy 求解 + 比較 |

### 實作功能

1. 前進消去 (Forward elimination)
2. 部分選主元 (Partial pivoting)
3. 回代 (Back substitution)
4. 檢測奇異情況
5. 視覺化消去過程

---

## 9. 考試重點

### 常見題型

1. **手算消去過程**：寫出每一步的矩陣
2. **回代求解**：給定上三角矩陣求解
3. **判斷解的情況**：唯一解/無解/無限多解
4. **消去矩陣**：寫出 E₂₁、E₃₁ 等

### 常見錯誤

- 忘記同時處理增廣部分（右手邊 b）
- 主元為零時沒有換列
- 回代時計算順序錯誤

---

## 10. 數值穩定性

### 為什麼需要選主元？

```
不選主元的問題：
ε·x + y = 1        (ε 很小，如 10⁻¹⁰)
x + y = 2

消去後：
ε·x + y = 1
(1 - 1/ε)y = 2 - 1/ε

當 ε → 0，1/ε → ∞，造成數值不穩定！
```

選主元可以避免這種問題。

---

## 參考資料

- Strang, Chapter 2.2-2.3
- MIT 18.06 Lecture 4-5
- Numerical Linear Algebra (Trefethen & Bau)
