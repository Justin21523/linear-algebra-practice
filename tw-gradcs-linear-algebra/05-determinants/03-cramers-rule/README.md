# 克萊姆法則 (Cramer's Rule)

> 用行列式解線性方程組的優雅公式

## 1. 克萊姆法則

### 定理

若 Ax = b 且 det(A) ≠ 0，則：

```
xⱼ = det(Aⱼ) / det(A)

其中 Aⱼ = 把 A 的第 j 行換成 b
```

### 矩陣 Aⱼ 的構造

```
A = [a₁ | a₂ | ... | aₙ]

Aⱼ = [a₁ | ... | aⱼ₋₁ | b | aⱼ₊₁ | ... | aₙ]
```

---

## 2. 2×2 系統

### 方程組

```
a₁₁x₁ + a₁₂x₂ = b₁
a₂₁x₁ + a₂₂x₂ = b₂
```

### 克萊姆法則

```
    |b₁  a₁₂|
x₁ = |b₂  a₂₂| / det(A)

    |a₁₁  b₁|
x₂ = |a₂₁  b₂| / det(A)
```

### 範例

```
2x + 3y = 8
4x + 5y = 14

det(A) = 2×5 - 3×4 = -2

    |8  3|
x = |14 5| / (-2) = (40 - 42) / (-2) = 1

    |2  8|
y = |4  14| / (-2) = (28 - 32) / (-2) = 2

解：x = 1, y = 2
```

---

## 3. 3×3 系統

### 範例

```
x + 2y + z = 6
2x + y + z = 5
x + y + 2z = 6
```

### 計算過程

```
    [1 2 1]
A = [2 1 1]
    [1 1 2]

det(A) = 1(2-1) - 2(4-1) + 1(2-1) = 1 - 6 + 1 = -4

    [6 2 1]
A₁ = [5 1 1]
    [6 1 2]

det(A₁) = 6(2-1) - 2(10-6) + 1(5-6) = 6 - 8 - 1 = -3

x = det(A₁)/det(A) = -3/(-4) = 0.75

同理計算 y, z...
```

---

## 4. 推導證明

### 從逆矩陣公式

```
x = A⁻¹b = (1/det(A)) adj(A) b

xⱼ = (1/det(A)) Σᵢ (adj(A))ⱼᵢ bᵢ
   = (1/det(A)) Σᵢ Cᵢⱼ bᵢ
   = (1/det(A)) det(Aⱼ)
```

### 關鍵觀察

```
Σᵢ Cᵢⱼ bᵢ 正是沿第 j 行展開 Aⱼ 的行列式
```

---

## 5. 優缺點分析

### 優點

| 優點 | 說明 |
|------|------|
| **公式簡潔** | 明確的數學表達式 |
| **理論價值** | 證明解的存在與唯一性 |
| **單一未知數** | 只需解一個未知數時效率高 |
| **符號計算** | 適合代數系統 |

### 缺點

| 缺點 | 說明 |
|------|------|
| **效率低** | O(n! × n) 時間複雜度 |
| **數值不穩** | 大矩陣誤差累積 |
| **只適用方陣** | 無法處理超定/欠定系統 |
| **det(A) ≠ 0** | 只處理可逆情況 |

---

## 6. 實際應用場景

### 適合使用克萊姆法則

- 2×2 或 3×3 小系統
- 只需要求部分未知數
- 教學和理論推導
- 符號代數運算

### 不適合使用

- 大型數值系統（用 LU 分解）
- 稀疏矩陣（用迭代法）
- 需要多次求解（預處理後重複使用）

---

## 7. 與其他方法比較

### 時間複雜度

| 方法 | 時間複雜度 |
|------|------------|
| 克萊姆法則 | O(n! × n) |
| 高斯消去 | O(n³) |
| LU 分解 | O(n³) |
| 迭代法 | O(kn²) |

### 數值穩定性

```
LU 分解（部分主元）> 高斯消去 > 克萊姆法則
```

---

## 8. 完整範例

### 問題

```
求解：
2x + y - z = 8
-3x - y + 2z = -11
-2x + y + 2z = -3
```

### 計算

```
    [ 2  1 -1]
A = [-3 -1  2]
    [-2  1  2]

det(A) = 2(-2-2) - 1(-6+4) + (-1)(-3-2)
       = 2(-4) - 1(-2) - 1(-5)
       = -8 + 2 + 5
       = -1

    [ 8  1 -1]
A₁ = [-11 -1  2]
    [-3  1  2]

det(A₁) = 8(-2-2) - 1(-22+6) + (-1)(-11-3)
        = -32 + 16 + 14
        = -2

x = det(A₁)/det(A) = -2/(-1) = 2

同理：
y = det(A₂)/det(A) = 3
z = det(A₃)/det(A) = -1

解：x = 2, y = 3, z = -1
```

### 驗證

```
2(2) + 3 - (-1) = 4 + 3 + 1 = 8 ✓
-3(2) - 3 + 2(-1) = -6 - 3 - 2 = -11 ✓
-2(2) + 3 + 2(-1) = -4 + 3 - 2 = -3 ✓
```

---

## 9. 程式實作

### 本單元程式示範

| 檔案 | 內容 |
|------|------|
| `cramers_rule_manual.py` | 手刻克萊姆法則 |
| `cramers_rule_numpy.py` | NumPy 實作 + 比較 |

---

## 10. 考試重點

### 常見題型

1. **用克萊姆法則解 2×2、3×3 系統**
2. **求特定未知數（只需算一個）**
3. **證明克萊姆法則**
4. **討論適用條件**

### 必背公式

```
xⱼ = det(Aⱼ) / det(A)

Aⱼ = A 的第 j 行換成 b
```

### 常見錯誤

- 把列換成 b（應該是行）
- 忘記 det(A) ≠ 0 的條件
- 計算行列式時符號錯誤

---

## 參考資料

- Strang, Chapter 5.3: Cramer's Rule
- Lay, Chapter 3.3: Cramer's Rule
