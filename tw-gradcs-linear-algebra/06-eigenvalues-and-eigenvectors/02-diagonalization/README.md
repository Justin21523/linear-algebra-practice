# 對角化 (Diagonalization)

> 本單元探討矩陣對角化的條件、意義與應用

## 1. 特徵值與特徵向量複習 (Review: Eigenvalues and Eigenvectors)

### 定義

對於一個 n×n 的方陣 A，若存在非零向量 **x** 與純量 λ 滿足：

```
A·x = λ·x
```

則稱：
- **λ** 為 A 的**特徵值 (eigenvalue)**
- **x** 為對應於 λ 的**特徵向量 (eigenvector)**

### 幾何意義

特徵向量是一個「方向不變」的向量——經過矩陣 A 的線性變換後，只有長度被縮放（縮放倍率即為特徵值），方向維持不變（或反向，當 λ < 0 時）。

### 計算方式

1. 解特徵多項式 (characteristic polynomial)：`det(A - λI) = 0`
2. 對每個 λ，解 `(A - λI)x = 0` 得到特徵向量

---

## 2. 可對角化矩陣 (Diagonalizable Matrices)

### 定義

若 n×n 矩陣 A 可以寫成：

```
A = P · D · P⁻¹
```

其中：
- **D** 是對角矩陣 (diagonal matrix)，對角線元素為 A 的特徵值
- **P** 是可逆矩陣，各行為 A 的特徵向量

則稱 A 是**可對角化的 (diagonalizable)**。

### 可對角化的條件

| 條件 | 說明 |
|------|------|
| **充分必要條件** | A 有 n 個線性獨立的特徵向量 |
| **充分條件** | A 有 n 個相異的特徵值 |
| **特例：對稱矩陣** | 實對稱矩陣 (real symmetric matrix) 必可對角化，且特徵向量互相正交 |

### 不可對角化的例子

```
A = [1  1]
    [0  1]
```

這個矩陣只有一個特徵值 λ = 1（代數重數 = 2），但只有一個線性獨立的特徵向量（幾何重數 = 1），因此不可對角化。

---

## 3. 對角化的威力 (Power of Diagonalization)

### 快速計算矩陣冪次

若 A = PDP⁻¹，則：

```
A² = (PDP⁻¹)(PDP⁻¹) = PD²P⁻¹
A³ = PD³P⁻¹
...
Aᵏ = PDᵏP⁻¹
```

對角矩陣的冪次非常容易計算：

```
D = [λ₁  0 ]    Dᵏ = [λ₁ᵏ  0  ]
    [0   λ₂]         [0    λ₂ᵏ]
```

### 範例：2×2 矩陣的 100 次方

直接計算 A¹⁰⁰ 需要 99 次矩陣乘法，但透過對角化：

```
A¹⁰⁰ = P · D¹⁰⁰ · P⁻¹
```

只需要：
1. 一次特徵值分解
2. 計算 λ₁¹⁰⁰ 和 λ₂¹⁰⁰（純量冪次）
3. 兩次矩陣乘法

---

## 4. 與差分方程 / 動態系統的連結 (Connection to Difference Equations / Dynamical Systems)

### 離散動態系統

考慮一階差分方程：

```
xₖ₊₁ = A · xₖ
```

其解為：

```
xₖ = Aᵏ · x₀
```

若 A 可對角化為 A = PDP⁻¹：

```
xₖ = P · Dᵏ · P⁻¹ · x₀
```

### 長期行為分析

設 A 的特徵值為 λ₁, λ₂, ..., λₙ，且 |λ₁| > |λ₂| ≥ ... ≥ |λₙ|：

- 若 |λ₁| > 1：系統發散
- 若 |λ₁| < 1：系統收斂到原點
- 若 |λ₁| = 1：系統穩定或週期性

### 主特徵向量收斂 (Power Iteration)

當我們反覆將一個向量乘上矩陣 A，經過正規化後，該向量會逐漸收斂到**主特徵向量** (dominant eigenvector)——也就是對應最大特徵值的特徵向量。

這就是 **冪次法 (Power Method)** 的原理，也是 Google PageRank 演算法的數學基礎。

---

## 5. 程式實作說明

### 本單元程式示範

1. **計算特徵值與特徵向量**：給定 2×2 或 3×3 矩陣
2. **驗證對角化**：確認 A = PDP⁻¹
3. **冪次法收斂**：觀察向量反覆乘上矩陣後收斂到主特徵向量

### 範例矩陣

```
A = [2  1]
    [1  2]
```

- 特徵值：λ₁ = 3, λ₂ = 1
- 特徵向量：v₁ = [1, 1]ᵀ, v₂ = [1, -1]ᵀ

### 檔案說明

| 檔案 | 說明 |
|------|------|
| `python/diagonalization_manual.py` | 手刻特徵值計算（限 2×2）+ 冪次法 |
| `python/diagonalization_numpy.py` | 使用 NumPy 的 `np.linalg.eig()` |
| `cpp/diagonalization_manual.cpp` | 手刻版本（限 2×2）+ 冪次法 |
| `cpp/diagonalization_eigen.cpp` | 使用 Eigen library |

---

## 6. 考試重點提示

### 常見題型

1. **判斷是否可對角化**：檢查特徵向量個數
2. **寫出 P, D, P⁻¹**：給定矩陣求對角化分解
3. **計算 Aⁿ**：利用對角化計算矩陣冪次
4. **差分方程求解**：xₖ = Aᵏx₀ 的長期行為

### 關鍵公式

```
det(A - λI) = 0          # 求特徵值
(A - λI)x = 0            # 求特徵向量
A = PDP⁻¹                # 對角化
Aᵏ = PDᵏP⁻¹              # 矩陣冪次
```

---

## 參考資料

- Strang, Chapter 6: Eigenvalues and Eigenvectors
- MIT 18.06 Lecture 21-22
