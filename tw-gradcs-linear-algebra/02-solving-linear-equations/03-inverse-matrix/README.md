# 反矩陣 (Inverse Matrix)

> 矩陣的「倒數」——理論重要，但實務要謹慎使用

## 1. 什麼是反矩陣？

### 定義

若方陣 A 存在另一個方陣 A⁻¹ 使得：

```
A · A⁻¹ = A⁻¹ · A = I
```

則稱 A⁻¹ 為 A 的**反矩陣**（inverse matrix）。

### 類比純量

```
數字：    5 × (1/5) = 1
矩陣：    A × A⁻¹ = I
```

但矩陣比數字複雜得多！

---

## 2. 可逆的條件 (Invertibility Conditions)

### A 可逆的等價條件

以下條件**全部等價**：

| 條件 | 說明 |
|------|------|
| A⁻¹ 存在 | 定義 |
| det(A) ≠ 0 | 行列式非零 |
| rank(A) = n | 滿秩 |
| Ax = 0 只有零解 | 零空間只有 {0} |
| A 的行向量線性獨立 | 列空間維度 = n |
| A 的列向量線性獨立 | 行空間維度 = n |
| A 的所有特徵值非零 | 特徵值條件 |

### 奇異矩陣 (Singular Matrix)

不可逆的矩陣稱為**奇異矩陣**：

```
    [1  2]
A = [2  4]   ← 第二列是第一列的 2 倍

det(A) = 1×4 - 2×2 = 0
A 不可逆
```

---

## 3. 2×2 矩陣的反矩陣公式

### 公式

```
    [a  b]              1    [d  -b]
A = [c  d]   →   A⁻¹ = ─── × [-c   a]
                      ad-bc
```

### 範例

```
    [4  7]              1    [2  -7]   [2/1  -7/1]   [2   -7]
A = [2  6]   →   A⁻¹ = ── × [-2  4] = [-2/10 4/10] = [-0.2  0.4]
                      10
```

驗證：det(A) = 4×6 - 7×2 = 24 - 14 = 10 ≠ 0 ✓

---

## 4. 高斯-乔丹消去法 (Gauss-Jordan Elimination)

### 方法

將增廣矩陣 [A | I] 化簡為 [I | A⁻¹]：

```
[A | I] → ... → [I | A⁻¹]
```

### 範例

```
    [2  1]
A = [5  3]

步驟 0：建立增廣矩陣
[2  1 | 1  0]
[5  3 | 0  1]

步驟 1：R₁ ← R₁/2
[1  0.5 | 0.5  0]
[5  3   | 0    1]

步驟 2：R₂ ← R₂ - 5R₁
[1  0.5 | 0.5   0]
[0  0.5 | -2.5  1]

步驟 3：R₂ ← R₂/0.5
[1  0.5 | 0.5  0]
[0  1   | -5   2]

步驟 4：R₁ ← R₁ - 0.5R₂
[1  0 | 3   -1]
[0  1 | -5   2]

結果：
      [3   -1]
A⁻¹ = [-5   2]
```

---

## 5. 反矩陣的性質

### 基本性質

| 性質 | 公式 |
|------|------|
| 唯一性 | A 的反矩陣若存在則唯一 |
| 雙重反矩陣 | (A⁻¹)⁻¹ = A |
| 乘積的反矩陣 | (AB)⁻¹ = B⁻¹A⁻¹ ← 順序反轉！|
| 轉置的反矩陣 | (Aᵀ)⁻¹ = (A⁻¹)ᵀ |
| 純量乘法 | (cA)⁻¹ = (1/c)A⁻¹ |
| 行列式 | det(A⁻¹) = 1/det(A) |

### (AB)⁻¹ = B⁻¹A⁻¹ 的證明

```
(AB)(B⁻¹A⁻¹) = A(BB⁻¹)A⁻¹ = AIA⁻¹ = AA⁻¹ = I ✓
```

### 推廣到多個矩陣

```
(ABC)⁻¹ = C⁻¹B⁻¹A⁻¹
```

就像「穿脫衣服」：先穿的後脫。

---

## 6. 用反矩陣解方程組？

### 理論上

```
Ax = b
x = A⁻¹b
```

### 實務上 ❌ 不推薦

```
# 不好的做法
x = np.linalg.inv(A) @ b

# 好的做法
x = np.linalg.solve(A, b)
```

### 原因

1. **效率低**：求 A⁻¹ 需要 O(n³)，再乘 b 需要 O(n²)
2. **數值不穩定**：求逆會放大誤差
3. **浪費計算**：如果只需要 x，不需要整個 A⁻¹

---

## 7. 反矩陣何時有用？

### 實際需要 A⁻¹ 時

- 理論推導（符號計算）
- 需要 A⁻¹ 的多個元素
- 某些迭代演算法需要 A⁻¹

### 特殊結構矩陣

有些矩陣的反矩陣有簡單形式：

```
對角矩陣：D⁻¹ = diag(1/d₁, 1/d₂, ..., 1/dₙ)
正交矩陣：Q⁻¹ = Qᵀ
置換矩陣：P⁻¹ = Pᵀ
```

---

## 8. 分塊矩陣的反矩陣

### 2×2 分塊

```
    [A  B]
M = [C  D]
```

若 A 和 Schur complement (D - CA⁻¹B) 都可逆：

```
       [A⁻¹ + A⁻¹BS⁻¹CA⁻¹   -A⁻¹BS⁻¹]
M⁻¹ =  [-S⁻¹CA⁻¹             S⁻¹    ]

其中 S = D - CA⁻¹B（Schur complement）
```

### 應用

- 大型稀疏矩陣的求解
- 機器學習中的 Woodbury 公式

---

## 9. 程式實作

### 本單元程式示範

| 檔案 | 內容 |
|------|------|
| `inverse_matrix_manual.py` | 高斯-乔丹法手刻實作 |
| `inverse_matrix_numpy.py` | NumPy 求反矩陣 + 注意事項 |

### NumPy 函數

```python
A_inv = np.linalg.inv(A)      # 求反矩陣
x = np.linalg.solve(A, b)     # 求解（推薦！）
```

---

## 10. 考試重點

### 常見題型

1. **手算 2×2 反矩陣**：用公式
2. **高斯-乔丹消去**：給定 3×3 矩陣求反矩陣
3. **判斷可逆性**：給定條件判斷是否可逆
4. **性質證明**：證明 (AB)⁻¹ = B⁻¹A⁻¹ 等

### 關鍵公式

```
2×2：A⁻¹ = (1/det) × [d  -b; -c  a]
(AB)⁻¹ = B⁻¹A⁻¹
(Aᵀ)⁻¹ = (A⁻¹)ᵀ
det(A⁻¹) = 1/det(A)
```

### 常見錯誤

- 忘記 (AB)⁻¹ 的順序要反轉
- 分母忘記檢查是否為零
- 高斯-乔丹消去時忘記同時處理右半部分

---

## 參考資料

- Strang, Chapter 2.5: Inverse Matrices
- MIT 18.06 Lecture 5
