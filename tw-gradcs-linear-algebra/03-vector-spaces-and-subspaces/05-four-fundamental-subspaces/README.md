# 四大基本子空間 (The Four Fundamental Subspaces)

> Gilbert Strang 線性代數的核心視角——理解矩陣的完整結構

## 1. 總覽

每個 m×n 矩陣 A 都有四個基本子空間：

| 子空間 | 記號 | 所在空間 | 維度 |
|--------|------|----------|------|
| 行空間 (Column space) | C(A) | ℝᵐ | r |
| 零空間 (Null space) | N(A) | ℝⁿ | n - r |
| 列空間 (Row space) | C(Aᵀ) | ℝⁿ | r |
| 左零空間 (Left null space) | N(Aᵀ) | ℝᵐ | m - r |

其中 r = rank(A)

---

## 2. 四大子空間的定義

### 行空間 C(A) — Column Space

```
C(A) = {Ax : x ∈ ℝⁿ} = span{A 的行向量}

在 ℝᵐ 中
維度 = r = rank(A)
```

**意義**：A 能「到達」的所有向量

### 零空間 N(A) — Null Space

```
N(A) = {x ∈ ℝⁿ : Ax = 0}

在 ℝⁿ 中
維度 = n - r = nullity(A)
```

**意義**：被 A「壓縮到零」的所有向量

### 列空間 C(Aᵀ) — Row Space

```
C(Aᵀ) = {Aᵀy : y ∈ ℝᵐ} = span{A 的列向量}

在 ℝⁿ 中
維度 = r = rank(A)
```

**意義**：A 的列向量張成的空間

### 左零空間 N(Aᵀ) — Left Null Space

```
N(Aᵀ) = {y ∈ ℝᵐ : Aᵀy = 0} = {y : yᵀA = 0ᵀ}

在 ℝᵐ 中
維度 = m - r
```

**意義**：從左邊乘 A 會得到零的向量

---

## 3. 正交關係 ⭐

### 核心定理

```
C(A) ⊥ N(Aᵀ)     在 ℝᵐ 中
C(Aᵀ) ⊥ N(A)     在 ℝⁿ 中
```

### 更精確地

```
ℝᵐ = C(A) ⊕ N(Aᵀ)    （直和分解）
ℝⁿ = C(Aᵀ) ⊕ N(A)
```

### 證明 C(Aᵀ) ⊥ N(A)

若 x ∈ N(A) 且 y ∈ C(Aᵀ)，則：
- Ax = 0
- y = Aᵀz（某個 z）

```
x · y = xᵀy = xᵀ(Aᵀz) = (Ax)ᵀz = 0ᵀz = 0 ✓
```

---

## 4. 維度公式

### 秩-零度定理（兩個版本）

```
對於 m×n 矩陣 A：

dim C(A) + dim N(Aᵀ) = m
dim C(Aᵀ) + dim N(A) = n

即：
r + (m - r) = m
r + (n - r) = n
```

### 大圖景

```
        ℝⁿ                              ℝᵐ
    ┌─────────┐                     ┌─────────┐
    │         │                     │         │
    │  C(Aᵀ)  │  ───── A ─────→     │  C(A)   │
    │  dim=r  │                     │  dim=r  │
    │         │                     │         │
    ├─────────┤                     ├─────────┤
    │         │                     │         │
    │   N(A)  │  ───── A ─────→     │  N(Aᵀ)  │
    │ dim=n-r │                     │ dim=m-r │
    │         │         0           │         │
    └─────────┘                     └─────────┘

    A 把 C(Aᵀ) 映射到 C(A)（一對一）
    A 把 N(A) 映射到 0
```

---

## 5. 找各子空間的基底

### 給定矩陣 A，如何找四個子空間的基底？

設 A 是 m×n 矩陣，RREF 有 r 個主元

### C(A) 的基底

RREF 的主元行對應的**原矩陣 A** 的行

### N(A) 的基底

對每個自由變數設 1，其他自由變數設 0，回代求特解

### C(Aᵀ) 的基底

RREF 的**非零列**（或原矩陣主元行對應的列）

### N(Aᵀ) 的基底

對 Aᵀ 求零空間，或用高斯消去過程中的消去步驟

---

## 6. 完整範例

```
    [1  3  5]
A = [2  6  10]   （2×3 矩陣）
```

### Step 1: RREF

```
    [1  3  5]     [1  3  5]
A = [2  6  10] →  [0  0  0]
```

rank(A) = 1，主元在第 1 行

### Step 2: 四個子空間

**C(A)**：
- 基底：A 的第 1 行 = [1, 2]ᵀ
- dim = 1
- 是 ℝ² 中的一條直線

**N(A)**：
- 自由變數：x₂, x₃
- 設 x₂=1, x₃=0：x₁ = -3，特解 [-3, 1, 0]ᵀ
- 設 x₂=0, x₃=1：x₁ = -5，特解 [-5, 0, 1]ᵀ
- 基底：{[-3,1,0]ᵀ, [-5,0,1]ᵀ}
- dim = 2
- 是 ℝ³ 中的一個平面

**C(Aᵀ)**：
- 基底：RREF 的非零列 = [1, 3, 5]
- dim = 1
- 是 ℝ³ 中的一條直線

**N(Aᵀ)**：
- Aᵀ = [1 2; 3 6; 5 10]
- Aᵀy = 0：y₁ + 2y₂ = 0（只有一個獨立方程）
- 特解：[-2, 1]ᵀ
- 基底：{[-2, 1]ᵀ}
- dim = 1

### Step 3: 驗證

```
維度檢查：
  dim C(A) + dim N(Aᵀ) = 1 + 1 = 2 = m ✓
  dim C(Aᵀ) + dim N(A) = 1 + 2 = 3 = n ✓

正交檢查：
  C(A) = span{[1,2]ᵀ}
  N(Aᵀ) = span{[-2,1]ᵀ}
  [1,2] · [-2,1] = -2 + 2 = 0 ✓
```

---

## 7. 應用

### Ax = b 的解

```
b ∈ C(A)  ⟺  Ax = b 有解
b ⊥ N(Aᵀ)  ⟺  Ax = b 有解（等價條件）
```

### 最小平方法

當 Ax = b 無解時，找 x 使 ‖Ax - b‖ 最小。
殘差 b - Ax̂ ∈ N(Aᵀ)（垂直於 C(A)）

### 投影

投影到 C(A) 的投影矩陣：P = A(AᵀA)⁻¹Aᵀ

---

## 8. 程式實作

### 本單元程式示範

| 檔案 | 內容 |
|------|------|
| `four_subspaces.py` | 計算四大子空間、驗證正交性 |

---

## 9. 考試重點

### 常見題型

1. **找四大子空間的基底和維度**
2. **驗證正交關係**
3. **用維度公式求未知維度**
4. **判斷向量屬於哪個子空間**

### 必背公式

```
dim C(A) = dim C(Aᵀ) = r
dim N(A) = n - r
dim N(Aᵀ) = m - r

C(A) ⊥ N(Aᵀ)
C(Aᵀ) ⊥ N(A)
```

### 常見錯誤

- 混淆哪個子空間在 ℝᵐ、哪個在 ℝⁿ
- 忘記「左零空間」的定義
- 正交關係的方向搞錯

---

## 參考資料

- Strang, Chapter 3.5: The Four Fundamental Subspaces
- MIT 18.06 Lecture 14（經典講解！）
- Strang 的「大圖景」（The Big Picture）
