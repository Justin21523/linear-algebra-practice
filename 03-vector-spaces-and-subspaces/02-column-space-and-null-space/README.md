# 行空間與零空間 (Column Space and Null Space)

> 理解 Ax = b 的解結構——行空間決定可解性，零空間決定解的個數

## 1. 行空間 (Column Space)

### 定義

矩陣 A 的**行空間** C(A) 是 A 的所有行向量的線性組合：

```
C(A) = {Ax : x ∈ ℝⁿ} = span{A 的各行}
```

### 理解方式

```
    [1  2]
A = [3  4]  的行向量是 [1,3]ᵀ 和 [2,4]ᵀ
    [5  6]

C(A) = span{[1,3,5]ᵀ, [2,4,6]ᵀ}
     = 所有 c₁[1,3,5]ᵀ + c₂[2,4,6]ᵀ 形成的集合
```

### 矩陣乘法的行觀點

```
      [| |]   [x₁]   [|]     [|]
Ax =  [a₁ a₂] [x₂] = x₁[a₁] + x₂[a₂]
      [| |]         [|]     [|]

Ax 是 A 的行向量的線性組合！
```

### 行空間的維度

```
dim C(A) = rank(A) = 主元 (pivot) 的數量
```

---

## 2. 零空間 (Null Space)

### 定義

矩陣 A 的**零空間** N(A) 是齊次方程 Ax = 0 的所有解：

```
N(A) = {x ∈ ℝⁿ : Ax = 0}
```

### 理解方式

零空間告訴我們：哪些 x 被 A 「壓縮」成零向量。

```
若 x ∈ N(A)，則 A 對 x 的作用是「消滅」它
```

### 零空間一定包含零向量

```
A·0 = 0  ⟹  0 ∈ N(A)
```

所以零空間至少有 {0}。

### 零空間的維度

```
dim N(A) = nullity(A) = 自由變數的數量 = n - rank(A)
```

---

## 3. Ax = b 的解結構

### 關鍵定理

```
Ax = b 有解  ⟺  b ∈ C(A)
```

**意義**：b 必須能被 A 的行向量線性組合出來。

### 解的三種情況

| 情況 | 條件 | 解的結構 |
|------|------|----------|
| **無解** | b ∉ C(A) | 空集合 |
| **唯一解** | b ∈ C(A)，且 N(A) = {0} | {x_p} |
| **無限多解** | b ∈ C(A)，且 N(A) ≠ {0} | x_p + N(A) |

### 通解 = 特解 + 齊次解

若 Ax = b 有解，則：

```
通解 = x_p + x_n

其中：
- x_p 是一個特解（滿足 Ax_p = b）
- x_n ∈ N(A) 是任意齊次解（滿足 Ax_n = 0）
```

**驗證**：A(x_p + x_n) = Ax_p + Ax_n = b + 0 = b ✓

---

## 4. 用 RREF 找零空間

### 步驟

1. 對 A 進行高斯消去，得到 RREF（簡化列階梯形式）
2. 識別主元行 (pivot columns) 和自由變數行
3. 對每個自由變數，設其為 1，其他為 0，回代求解
4. 這些特解組成零空間的基底

### 範例

```
    [1  2  2  2]
A = [2  4  6  8]
    [3  6  8  10]

RREF:
    [1  2  0  -2]
R = [0  0  1   2]
    [0  0  0   0]

主元行：第 1、3 行
自由變數：x₂, x₄

設 x₂ = 1, x₄ = 0：
  x₁ + 2(1) = 0 ⟹ x₁ = -2
  x₃ = 0
  特解 1：[-2, 1, 0, 0]ᵀ

設 x₂ = 0, x₄ = 1：
  x₁ - 2(1) = 0 ⟹ x₁ = 2
  x₃ + 2(1) = 0 ⟹ x₃ = -2
  特解 2：[2, 0, -2, 1]ᵀ

零空間基底：{[-2, 1, 0, 0]ᵀ, [2, 0, -2, 1]ᵀ}
dim N(A) = 2（兩個自由變數）
```

---

## 5. 用 RREF 找行空間

### 方法 1：RREF 的非零列給出列空間基底

注意：RREF 改變了行向量！

### 方法 2：RREF 的主元行對應原矩陣的基底

```
若 RREF 的主元在第 j₁, j₂, ..., jᵣ 行
則 A 的第 j₁, j₂, ..., jᵣ 行是 C(A) 的基底
```

### 範例

```
    [1  2  2  2]
A = [2  4  6  8]
    [3  6  8  10]

RREF 主元在第 1、3 行

C(A) 的基底：A 的第 1、3 行
= {[1, 2, 3]ᵀ, [2, 6, 8]ᵀ}

dim C(A) = 2
```

---

## 6. 秩-零度定理 (Rank-Nullity Theorem)

### 定理

對於 m×n 矩陣 A：

```
rank(A) + nullity(A) = n

即：dim C(A) + dim N(A) = A 的行數
```

### 直覺理解

- n 個變數分成兩類：主元變數和自由變數
- 主元數 = rank = 行空間維度
- 自由變數數 = nullity = 零空間維度
- 主元數 + 自由變數數 = n

### 範例驗證

```
    [1  2  2  2]
A = [2  4  6  8]   （3×4 矩陣）
    [3  6  8  10]

rank(A) = 2（2 個主元）
nullity(A) = 2（2 個自由變數）

rank + nullity = 2 + 2 = 4 = n ✓
```

---

## 7. 程式實作

### 本單元程式示範

| 檔案 | 內容 |
|------|------|
| `column_null_space.py` | 計算行空間和零空間的基底 |

### NumPy 函數

```python
# 零空間
from scipy.linalg import null_space
N = null_space(A)

# 秩
rank = np.linalg.matrix_rank(A)

# 行空間基底（使用 SVD 或 QR）
Q, R = np.linalg.qr(A)
```

---

## 8. 考試重點

### 常見題型

1. **求零空間**：給定矩陣，求 N(A) 的基底和維度
2. **求行空間**：求 C(A) 的基底和維度
3. **判斷解**：給定 Ax = b，判斷有幾個解
4. **秩-零度定理**：計算 rank 和 nullity

### 關鍵概念

```
b ∈ C(A) ⟺ Ax = b 有解
dim N(A) = 0 ⟺ 解唯一（若有解）
dim N(A) > 0 ⟺ 解有無限多個（若有解）
```

### 常見錯誤

- 混淆列空間和行空間
- 零空間基底的元素個數算錯
- 忘記驗證特解確實滿足 Ax = 0

---

## 參考資料

- Strang, Chapter 3.2: The Null Space of A
- Strang, Chapter 3.3: The Column Space of A
- MIT 18.06 Lecture 10-11
