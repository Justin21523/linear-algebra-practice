# 餘因子展開 (Cofactor Expansion)

> 遞迴計算行列式的標準方法

## 1. 基本定義

### 子行列式 (Minor)

```
Mᵢⱼ = 去掉第 i 列、第 j 行後的 (n-1)×(n-1) 行列式

例如：
    [a  b  c]
A = [d  e  f]
    [g  h  i]

M₁₂ = det([a  c])  （去掉第 1 列、第 2 行）
          [g  i]
    = ai - cg
```

### 餘因子 (Cofactor)

```
Cᵢⱼ = (-1)^(i+j) × Mᵢⱼ

符號模式：
[+  -  +  - ...]
[-  +  -  + ...]
[+  -  +  - ...]
[...          ]
```

---

## 2. 餘因子展開公式

### 沿第 i 列展開

```
det(A) = Σⱼ aᵢⱼ Cᵢⱼ
       = aᵢ₁Cᵢ₁ + aᵢ₂Cᵢ₂ + ... + aᵢₙCᵢₙ
```

### 沿第 j 行展開

```
det(A) = Σᵢ aᵢⱼ Cᵢⱼ
       = a₁ⱼC₁ⱼ + a₂ⱼC₂ⱼ + ... + aₘⱼCₘⱼ
```

### 重要性質

```
沿任何列或行展開，結果相同！
```

---

## 3. 3×3 行列式展開

### 範例矩陣

```
    [1  2  3]
A = [4  5  6]
    [7  8  9]
```

### 沿第一列展開

```
det(A) = a₁₁C₁₁ + a₁₂C₁₂ + a₁₃C₁₃

       = 1·(+1)·det([5 6]) + 2·(-1)·det([4 6]) + 3·(+1)·det([4 5])
                   [8 9]            [7 9]            [7 8]

       = 1·(5×9 - 6×8) - 2·(4×9 - 6×7) + 3·(4×8 - 5×7)
       = 1·(45 - 48) - 2·(36 - 42) + 3·(32 - 35)
       = 1·(-3) - 2·(-6) + 3·(-3)
       = -3 + 12 - 9
       = 0
```

### 沿第一行展開

```
det(A) = a₁₁C₁₁ + a₂₁C₂₁ + a₃₁C₃₁

       = 1·(+1)·det([5 6]) + 4·(-1)·det([2 3]) + 7·(+1)·det([2 3])
                   [8 9]            [8 9]            [5 6]

       = 1·(-3) - 4·(18-24) + 7·(12-15)
       = -3 - 4·(-6) + 7·(-3)
       = -3 + 24 - 21
       = 0
```

---

## 4. 選擇展開的策略

### 策略 1：選擇最多零的列/行

```
    [1  0  0]
A = [2  3  0]
    [4  5  6]

沿第一列展開（兩個零）：
det(A) = 1·C₁₁ + 0·C₁₂ + 0·C₁₃
       = 1·det([3 0])
              [5 6]
       = 1·(18) = 18
```

### 策略 2：三角矩陣

```
上/下三角矩陣的行列式 = 對角線乘積
（因為展開時只有對角線元素有貢獻）
```

---

## 5. 餘因子矩陣與伴隨矩陣

### 餘因子矩陣 (Cofactor Matrix)

```
C = [Cᵢⱼ] = 每個位置放該位置的餘因子
```

### 伴隨矩陣 (Adjugate Matrix)

```
adj(A) = Cᵀ = 餘因子矩陣的轉置
```

### 逆矩陣公式

```
A⁻¹ = (1/det(A)) × adj(A)

這是理論上重要，但計算上低效的公式
```

---

## 6. 完整範例

### 計算 3×3 行列式

```
    [2  1  3]
A = [1  0  2]
    [4  1  5]
```

### 沿第二列展開（有一個零）

```
det(A) = a₂₁C₂₁ + a₂₂C₂₂ + a₂₃C₂₃
       = 1·(-1)^(2+1)·det([1 3]) + 0·(...) + 2·(-1)^(2+3)·det([2 1])
                         [1 5]                              [4 1]

       = -1·(5-3) + 0 - 2·(2-4)
       = -1·2 - 2·(-2)
       = -2 + 4
       = 2
```

### 計算餘因子矩陣

```
C₁₁ = +det([0 2]) = 0-2 = -2
          [1 5]

C₁₂ = -det([1 2]) = -(5-8) = 3
          [4 5]

C₁₃ = +det([1 0]) = 1-0 = 1
          [4 1]

C₂₁ = -det([1 3]) = -(5-3) = -2
          [1 5]

C₂₂ = +det([2 3]) = 10-12 = -2
          [4 5]

C₂₃ = -det([2 1]) = -(2-4) = 2
          [4 1]

C₃₁ = +det([1 3]) = 2-0 = 2
          [0 2]

C₃₂ = -det([2 3]) = -(4-3) = -1
          [1 2]

C₃₃ = +det([2 1]) = 0-1 = -1
          [1 0]

      [-2   3   1]
C =   [-2  -2   2]
      [ 2  -1  -1]
```

### 計算伴隨矩陣

```
           [-2  -2   2]
adj(A) = Cᵀ = [ 3  -2  -1]
           [ 1   2  -1]
```

### 計算逆矩陣

```
A⁻¹ = (1/det(A)) × adj(A)
    = (1/2) × adj(A)

    [-1   -1    1  ]
=   [1.5  -1  -0.5]
    [0.5   1  -0.5]
```

---

## 7. 時間複雜度

### 餘因子展開

```
T(n) = n × T(n-1)
T(n) = O(n!)

非常低效！只適合小矩陣或理論分析
```

### 比較

| 方法 | 時間複雜度 |
|------|------------|
| 餘因子展開 | O(n!) |
| LU 分解 | O(n³) |
| 列運算 | O(n³) |

---

## 8. 程式實作

### 本單元程式示範

| 檔案 | 內容 |
|------|------|
| `cofactor_manual.py` | 手刻餘因子展開 |
| `cofactor_numpy.py` | NumPy 實作 + 伴隨矩陣 |

---

## 9. 考試重點

### 常見題型

1. **用餘因子展開計算行列式**
2. **計算特定餘因子 Cᵢⱼ**
3. **計算伴隨矩陣**
4. **用伴隨矩陣求逆矩陣**

### 必背公式

```
Cᵢⱼ = (-1)^(i+j) × Mᵢⱼ

det(A) = Σⱼ aᵢⱼ Cᵢⱼ（沿第 i 列）

adj(A) = Cᵀ

A⁻¹ = adj(A) / det(A)
```

### 常見錯誤

- 忘記 (-1)^(i+j) 的正負號
- 混淆子行列式和餘因子
- 伴隨矩陣要轉置

---

## 參考資料

- Strang, Chapter 5.2: Permutations and Cofactors
- Lay, Chapter 3.1: Cofactor Expansion
